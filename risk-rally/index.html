<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Risk Rally</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://unpkg.com/vue-router@4"></script>
    <style>
      body {
        background-color: white;
        color: black; /* Add text color */
        font-family: Arial, sans-serif;
        text-align: center;
        margin: 0;
        padding: 20px;
        transition:
          background-color 0.3s,
          color 0.3s; /* Add smooth transition */
      }

      /* Dark Mode */
      @media (prefers-color-scheme: dark) {
        body {
          background-color: #121212;
          color: gray;
        }
      }
      .question-container,
      .game-container {
        margin: 50px auto;
        padding: 20px;
        background-color: #f9f9f9;
        border: 1px solid #ddd;
        width: 60%;
        transition: opacity 0.5s ease-in-out;
      }
      input[type='text'] {
        padding: 10px;
        margin: 10px 0;
        width: 80%;
        font-size: 1em;
      }
      button {
        padding: 10px 20px;
        background-color: #007bff;
        color: white;
        border: none;
        font-size: 1em;
        cursor: pointer;
      }
      button:hover {
        background-color: #0056b3;
      }
    </style>
  </head>
  <body>
    <div id="app">
      <!-- Navigation -->
      <nav>
        <router-link to="/">Questionnaire</router-link> |
        <router-link to="/game">Mini Game (dev)</router-link> |
        <router-link to="/RiskGame">Risk Game</router-link>
      </nav>

      <!-- Router View -->
      <router-view />
    </div>

    <script>
      // Questionnaire Component
      const Questionnaire = {
        template: `
          <div>
            <h1>Risk Rally</h1>
            <transition name="fade">
              <div v-if="!completed" class="question-container" :key="currentIndex">
                <p>{{ currentQuestion }}</p>
                <form @submit.prevent="nextQuestion">
                  <input type="text" v-model="answer" required />
                  <button type="submit">Next</button>
                </form>
              </div>
            </transition>
            <div v-if="completed" class="results-container">
              <h2>Thank you for completing the questionnaire!</h2>
              <p>Here are your answers:</p>
              <ul>
                <li v-for="(answer, index) in answers" :key="index">
                  <strong>{{ questions[index] }}:</strong> {{ answer }}
                </li>
              </ul>
              <button @click="restart">Restart</button>
            </div>
          </div>
        `,
        data() {
          return {
            questions: [
              'What is your age?',
              'What is your profession?',
              'What is your risk tolerance on a scale from 1 to 10?',
              'What is your risk tolerance on a scale from 1 to 10?',
              ''
            ],
            currentIndex: 0,
            answer: '',
            answers: [],
            completed: false
          }
        },
        computed: {
          currentQuestion() {
            return this.questions[this.currentIndex] || null
          }
        },
        methods: {
          nextQuestion() {
            this.answers.push(this.answer)
            this.answer = '' // Clear input field
            if (this.currentIndex < this.questions.length - 1) {
              this.currentIndex++
            } else {
              this.completed = true // Mark as completed
            }
          },
          restart() {
            this.currentIndex = 0
            this.answers = []
            this.answer = ''
            this.completed = false
          }
        }
      }

      // Mini Game Component
      const MiniGame = {
        template: `
        <RiskGameView/>
        `,
        data() {
          return {
            result: ''
          }
        },
        methods: {
          playGame() {
            const randomNumber = Math.random()
            if (randomNumber > 0.5) {
              this.result = 'You win!'
            } else {
              this.result = 'You lose!'
            }
          }
        }
      }

      // Detect and apply dark mode dynamically
      const applyDarkMode = () => {
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
          document.body.style.backgroundColor = '#121212'
          document.body.style.color = 'white'
        } else {
          document.body.style.backgroundColor = 'white'
          document.body.style.color = 'black'
        }
      }

      // Initial check
      //applyDarkMode()

      // Listen for changes in the preferred color scheme
      window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', applyDarkMode)

      import RiskGameView from './src/views/RiskGameView.vue'

      // Routes configuration
      const routes = [
        { path: '/', component: Questionnaire },
        { path: '/game', component: MiniGame },
        { path: '/RiskGame', component: RiskGameView }
        //{ path: '/RiskGame', component: }x
      ]

      // Create Router
      const router = VueRouter.createRouter({
        history: VueRouter.createWebHashHistory(),
        routes
      })

      // Create Vue App
      const app = Vue.createApp({})
      app.use(router)
      app.mount('#app')
    </script>
  </body>
</html>
